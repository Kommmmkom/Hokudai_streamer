# DBD Toy Simulation（誘電体バリア放電）- 簡易モデル

**誘電体バリア放電（DBD）**の代表的な**リサージュ図形（Q-V）**を再現し、**ループ面積から平均電力**を見積もる極小モデルです。  
Jupyter でも単体スクリプトでも動作します。

---

## 特徴
- **等価回路による最小表現**：ガス容量 `C_g` と誘電体容量 `C_d` の直列 + イベント駆動の電荷ジャンプ
- **DBDの本質を可視化**：Q-V ループ、V_a/V_g の時間波形、マイクロ放電のインパルス
- **電力推定**：`P_avg = f × (Q-V ループ面積)`（最後の1周期を積分）

---

## モデル概要

1 セル（半径 `r`）を以下の集中定数回路として扱います：

- ガス：`C_g = ε0 ・ A / d_g`  
- 誘電体：`C_d = ε0 ・ ε_r ・ A / d_b`  
- 直列等価容量：`C_eq = (C_d ・ C_g) / (C_d + C_g)`

駆動電圧：`V_a(t) = V0 ・ sin(2π f t)`  
ギャップ電圧：`V_g = V_a ? V_d`，`V_d = Q / C_d`  
破壊条件：`|E_g| = |V_g| / d_g ? E_br` を満たしたとき **マイクロ放電**を即時発生させ，  
`Q ← Q + sign(V_g) ・ q_event` を与えます。

**電力評価**（最後の 1 周期）  
- エネルギー：`W_cycle = ∮ V_a dQ`（台形公式）  
- 平均電力：`P_avg = f ・ W_cycle`

---

## リポジトリ構成

```
.
├── dbd_toy_simulation.py     # そのまま実行できるスクリプト
├── README.md                 # このファイル
└── notebooks/
    └── dbd_demo.ipynb        # ノートブック（任意）
```

---

## 必要環境
- Python 3.9+
- numpy, matplotlib（Jupyter で表を表示するなら pandas は任意）

---

## インストール
```bash
pip install numpy matplotlib
```

---

## クイックスタート
スクリプト実行：
```bash
python dbd_toy_simulation.py
```
出力：
- **リサージュ（Q?V）**：最後の1周期を太線で強調
- **電圧波形**：`V_a` と `V_g`（放電で階段状の挙動）
- 容量値・イベント回数・エネルギー・**平均電力**の概要

---

## Jupyter からの利用
```python
from dbd_toy_simulation import simulate_and_plot

out = simulate_and_plot(
    V0=6000.0,        # 駆動電圧 [V]
    f=10_000.0,       # 周波数 [Hz]
    cycles=6,         # 計算周期数
    E_br=3.0e6,       # 破壊電界 [V/m]
    r=2.5e-4,         # セル半径 [m]
    d_b=5.0e-4,       # 誘電体厚さ [m]
    eps_r=5.0,        # 誘電率 [-]
    d_g=1.0e-3,       # ギャップ厚さ [m]
    q_event=1.0e-11,  # 放電1回あたり電荷 [C]
    dt_per_period=4000,  # 1周期の分割数
    make_plots=True
)

out["P_avg"], out["W_cycle"], out["events"]
```

返り値（主なキー）：`C_d, C_g, C_eq, A, T, V_br, events, W_cycle, P_avg, t, Va, Q, Vg`

---

## 主要パラメータ

| パラメータ | 意味 | 典型値 | 効果の目安 |
|---|---|---|---|
| `V0` | 駆動電圧ピーク [V] | 2?10 kV | 高いほど放電回数↑／ループ肥大 |
| `f` | 周波数 [Hz] | 1?50 kHz | 面積一定でも P は f に比例 |
| `E_br` | 破壊電界 [V/m] | ?3×10? | 高いほど放電回数↓ |
| `r` | セル半径 [m] | 0.1?0.5 mm | `A` 比例→容量増→ループ拡大 |
| `d_b` | 誘電体厚さ [m] | 0.2?1.0 mm | 薄いほど `C_d`↑→傾き変化 |
| `eps_r` | 誘電率 [-] | 4?8 | 大きいほど `C_d`↑ |
| `d_g` | ギャップ厚さ [m] | 0.3?2.0 mm | 厚いほど `V_br`↑（放電しにくい） |
| `q_event` | 放電1回あたり電荷 [C] | 1?50 pC | ループが太る／P↑ |
| `dt_per_period` | 1周期の分割数 | 2000?8000 | 粗いと誤差↑／細かいと滑らか |

---

## 出力（プロット）
1. **リサージュ（Q?V）**：最後の 1 周期を太線で強調  
2. **電圧波形（最後の1周期）**：`V_a` と `V_g`。放電で階段状の挙動  
3. **マイクロ放電イベント**（任意）：最後の 1 周期における `ΔQ` のスティック図

---

## 見せ方の例
1. **純容量の確認**：`q_event = 0` → Q?V は直線、面積 ? 0 → **P ? 0**  
2. **放電を導入**：`q_event = 10e-12`（10 pC）→ 段差ループ、**P > 0**  
3. **破壊条件の感度**：`E_br` や `d_g` を変えて放電回数の違いを比較  
4. **誘電体効果**：`eps_r` や `d_b` を変えて傾きを観察  
5. **時間解像度の影響**：`dt_per_period` を粗く→面積誤差、細かく→改善

---

## アルゴリズム
1. `V_a(t)` を更新  
2. **変位電流のみ**：`Q ← Q + C_eq ・ ΔV_a`  
3. `V_d = Q/C_d`，`V_g = V_a ? V_d` を更新  
4. `|V_g| ? V_br` の間：`Q ← Q + sign(V_g) ・ q_event` を繰り返し  
5. 最後の 1 周期で `W_cycle = ∮ V_a dQ`（台形公式），`P_avg = f ・ W_cycle`

---

## 前提・限界
- **単一セル**集中定数モデル（空間展開なし）
- 放電は**瞬時イベント**で常に同一 `q_event`
- ガス化学・温度上昇・拡散・リークなし（記憶は表面電荷のみ）
- 破壊判定は**離散時間**依存 → `dt_per_period` が粗いと誤差
- Q?V 面積からの電力は**教育用近似**

---

## 拡張案
- **クランプ型放電**：イベントで `V_g → V_hold` に強制  
- **表面リーク**：`R_d` を `C_d` に並列追加（表面電荷の減衰）  
- **確率化**：`q_event` を分布化，`E_br` に揺らぎを導入  
- **多セル配列**：複数セルを並列にして総電荷を合算

---


